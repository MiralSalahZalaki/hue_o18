<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="treasury_report_template">
        <t t-set="data_report_landscape" t-value="True"/>
        <t t-set="full_width" t-value="True"/>
        <t t-call="web.html_container">
            <head>
                <meta charset="UTF-8"/>
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <link rel="preconnect" href="https://fonts.googleapis.com"/>
                <link rel="preconnect" href="https://fonts.gstatic.com" />
                <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&amp;display=swap" rel="stylesheet"/>
                <link rel="stylesheet" type="text/css" href="/mc_app/static/mc_reports_style.css" />
            </head>
            <div class="page">
                <div class="my-3">
                    <button class="print-button" style="background: #2c3691; color: #fff; border-radius:4px; border:none" onclick="window.print();">
                        <i class="fa fa-print"/> Print
                    </button>
                </div>
                <div class=" mt-5" >
                    <!-- Report Header -->
                    <div class="row mb-4">
                        <div class="d-flex justify-content-between align-items-center align-items-sm-start border-bottom border-2 border-dark">
                            <h4 class="mb-0">Accountant Treasury Report</h4>
                            <div class="col-6" style="display: flex; justify-content: end;">
                                <img src="/mc_app/static/description/mclogo.png" class="d-none d-lg-block" alt=""
                                style="width: 150px;"/>
                            </div>
                        </div>
                    </div>
                    <!-- Information Table -->
                    <div class="row">
                        <div class="col-12">
                            <table class="table table-striped table-bordered">
                                <tbody>
                                    <tr style="background: #2c36911a;">
                                        <td class="text-center" colspan="3">
                                            <span>Accountant: </span>
                                            <span>
                                                <t t-esc="employee_name"/>
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="text-left">
                                            <strong>Date from: </strong>
                                            <t t-esc="date_from if isinstance(date_from, str) else date_from.strftime('%Y-%m-%d')"/>
                                        </td>
                                        <td class="text-left">
                                            <strong>Date to: </strong>
                                            <t t-esc="date_to if isinstance(date_to, str) else date_to.strftime('%Y-%m-%d')"/>
                                        </td>
                                        <td class="text-left"></td>
                                    </tr>
                                    <tr>
                                        <td class="text-left">
                                            <strong>Account Journal: </strong>
                                            <t t-esc="account_journal if account_journal else 'All'"/>
                                        </td>
                                        <td class="text-left">
                                            <strong>Category: </strong>
                                            <t t-esc="fee_category_id if fee_category_id else 'All'"/>
                                        </td>
                                        <td class="text-left">
                                            <strong>Term: </strong>
                                            <t t-esc="fee_payment_term if fee_payment_term else 'All'"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <!-- Data Table -->
                            <table style="font-size: 14px !important;" class="table table-sm table-bordered table-striped table-responsive table-condensed">
                                <thead>
                                    <tr class="text-center font-weight-bold" style="background: #2c3691; ">
                                        <th  style="color: #fff; width:30px">#</th>
                                        <th class="text-left" style="color: #fff;">Receipt</th>
                                        <th class="text-left" style="color: #fff;">Date</th>
                                        <th class="text-center" style="color: #fff;">STD Code</th>
                                        <th class="text-center" style="color: #fff;">Name</th>
                                        <th class="text-center" style="color: #fff;">Grade</th>
                                        <th class="text-center" style="color: #fff;">INV Type</th>
                                        <th class="text-center" style="color: #fff;">INV Num</th>
                                        <th class="text-center" style="color: #fff; width:70px" >Currency</th>
                                        <th class="text-center" style="color: #fff;">Journal</th>
                                        <th class="text-center" style="color: #fff;">Sales Person</th>
                                        <th class="text-center" style="color: #fff;">Paid Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="treasury_data" t-as="record">
                                        <tr>
                                            <td>
                                                <t t-esc="record_index + 1"/>
                                            </td>
                                            <td>
                                                <t t-esc="record['receipt_number']"/>
                                            </td>
                                            <td>
                                                <t t-esc="record['date'] if isinstance(record['date'], str) else record['date'].strftime('%Y-%m-%d')"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['student_code']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['student_name']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['grade']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['invoice_type']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['invoice_number']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['currency']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['journal']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['sales_person']"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="record['paid_amount']" t-options="{'widget': 'float', 'decimal_precision': 'Account'}"/>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr style="background: #2c36911a;">
                                        <td colspan="11" class="text-right">
                                            <strong>Total:</strong>
                                        </td>
                                        <td class="text-center" style="font-weight:bold">
                                            <t t-esc="sum(record['paid_amount'] for record in treasury_data)" 
                                            t-options="{'widget': 'float', 'decimal_precision': 'Account'}"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- Report Footer -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="text-center text-muted">
                                <small>Generated on:
                                    <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M:%S')"/>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>